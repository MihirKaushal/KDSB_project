---
title: "KDSB Project"
author: "Mihir Kaushal"
output: 
  html_document:
    css: styles.css  # Optional: Customize CSS for better control over layout
    fig_width: 100%
    fig_height: 100%
    fig_caption: yes
    keep_md: true  # Keep the intermediate Markdown file for better control
execute: 
  echo: false 
  message: false 
  warning: false 
---

```{r}
#| label: setup 
library(tidyverse)
library(ggplot2)
library(dplyr)
library(scales)
library(repr)

usedata <- read_csv("motor_theft_chicago_2001-now.csv")

p <- ggplot(usedata, aes(x = Year, fill = Arrest)) + 
     geom_bar(alpha = 0.7, color = "black", width = 1, stat = "count") + 
     scale_y_continuous(labels = comma) + 
     scale_x_continuous(breaks = c(2001:2024)) +  
     theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
     labs(title = "Auto Theft in Chicago from 2001 to Present", 
          subtitle = "Most cases did not lead to arrests and the overall number of cases \n were decreasing but increase again in 2022.", 
          x = "Year", 
          y = "Number of Cases", 
          caption = "Source: data.cityofchicago.org") + 
     theme(plot.title = element_text(size = 36, color = "white"), 
  plot.subtitle = element_text(size = 28, color = "white"),
  axis.title.x = element_text(size = 24, color = "white"), 
  axis.title.y = element_text(size = 24, color = "white"), 
  axis.text.x = element_text(size = 16, color = "white"), 
  axis.text.y = element_text(size = 16, color = "white"), 
  plot.caption = element_text(size = 24, color = "white"),
  legend.text = element_text(size = 24), 
  legend.title = element_text(size = 24),
  legend.key.size = unit(2, "cm"), 
  legend.background = element_rect(fill = "gray90"),
  plot.margin = margin(2, 2, 2, 2, "cm"),
  panel.background = element_rect(fill = "black"),
  plot.background = element_rect(fill = "black", colour = "darkgray"))

ggsave("my_plot.png", plot = p, width = 18, height = 12, units = "in", limitsize = FALSE)

knitr::include_graphics("my_plot.png")
```



